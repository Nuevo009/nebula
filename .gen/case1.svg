<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="443px" preserveAspectRatio="none" style="width:436px;height:443px;" version="1.1" viewBox="0 0 436 443" width="436px" zoomAndPan="magnify"><defs><filter height="300%" id="flasic54g2cf0" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="228" x="106.5" y="28.708">Case 1: Good handshake</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="123.25" y2="355.0469"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="263" x2="263" y1="123.25" y2="355.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="35" y="119.9482">Initiator</text><ellipse cx="67" cy="49.9531" fill="#FEFECE" filter="url(#flasic54g2cf0)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M67,57.9531 L67,84.9531 M54,65.9531 L80,65.9531 M67,84.9531 L54,99.9531 M67,84.9531 L80,99.9531 " fill="none" filter="url(#flasic54g2cf0)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="221" y="119.9482">Responder</text><ellipse cx="263" cy="49.9531" fill="#FEFECE" filter="url(#flasic54g2cf0)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M263,57.9531 L263,84.9531 M250,65.9531 L276,65.9531 M263,84.9531 L250,99.9531 M263,84.9531 L276,99.9531 " fill="none" filter="url(#flasic54g2cf0)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="35" y="435.042">Initiator</text><ellipse cx="67" cy="365.0469" fill="#FEFECE" filter="url(#flasic54g2cf0)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M67,373.0469 L67,400.0469 M54,381.0469 L80,381.0469 M67,400.0469 L54,415.0469 M67,400.0469 L80,415.0469 " fill="none" filter="url(#flasic54g2cf0)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="221" y="435.042">Responder</text><ellipse cx="263" cy="365.0469" fill="#FEFECE" filter="url(#flasic54g2cf0)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M263,373.0469 L263,400.0469 M250,381.0469 L276,381.0469 M263,400.0469 L250,415.0469 M263,400.0469 L276,415.0469 " fill="none" filter="url(#flasic54g2cf0)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="55,148.3828,65,152.3828,55,156.3828,59,152.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="61" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="17" y="147.3169">tun rx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="109" y1="181.5156" y2="181.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="181.5156" y2="194.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="68" x2="109" y1="194.5156" y2="194.5156"/><polygon fill="#A80036" points="78,190.5156,68,194.5156,78,198.5156,74,194.5156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="74" y="176.4497">Stage 0: Prepare handshake</text><polygon fill="#A80036" points="251,219.6484,261,223.6484,251,227.6484,255,223.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="257" y1="223.6484" y2="223.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="117.5" y="218.5825">stage 1 packet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="263" x2="305" y1="252.7813" y2="252.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="305" x2="305" y1="252.7813" y2="265.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="264" x2="305" y1="265.7813" y2="265.7813"/><polygon fill="#A80036" points="274,261.7813,264,265.7813,274,269.7813,270,265.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="270" y="247.7153">Stage 1: Stand up tunnel</text><polygon fill="#A80036" points="78,290.9141,68,294.9141,78,298.9141,74,294.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="72" x2="262" y1="294.9141" y2="294.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="117" y="289.8481">Stage 2 packet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="67" x2="109" y1="324.0469" y2="324.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="109" y1="324.0469" y2="337.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="68" x2="109" y1="337.0469" y2="337.0469"/><polygon fill="#A80036" points="78,333.0469,68,337.0469,78,341.0469,74,337.0469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="74" y="318.981">Stage 2: Stand up tunnel</text><!--MD5=[6e0367133a50426223309013feb9d84c]
@startuml
title Case 1: Good handshake

!pragma teoz true
skinparam sequenceMessageAlign center

actor "Initiator" as i
actor "Responder" as r

-> i: tun rx
i -> i: Stage 0: Prepare handshake
i -> r: stage 1 packet

r -> r: Stage 1: Stand up tunnel

r -> i: Stage 2 packet
i -> i: Stage 2: Stand up tunnel
@enduml

PlantUML version 1.2021.5beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>