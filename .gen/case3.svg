<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="514px" preserveAspectRatio="none" style="width:622px;height:514px;" version="1.1" viewBox="0 0 622 514" width="622px" zoomAndPan="magnify"><defs><filter height="300%" id="fg5dppne2o3jh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="373" x="127.25" y="28.708">Case 3: Wrong responder loses the race</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="72.5" x2="72.5" y1="123.25" y2="426.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="241.5" x2="241.5" y1="123.25" y2="426.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="453.5" x2="453.5" y1="123.25" y2="426.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="5" y="119.9482">Wrong Responder</text><ellipse cx="72.5" cy="49.9531" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M72.5,57.9531 L72.5,84.9531 M59.5,65.9531 L85.5,65.9531 M72.5,84.9531 L59.5,99.9531 M72.5,84.9531 L85.5,99.9531 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="209.5" y="119.9482">Initiator</text><ellipse cx="241.5" cy="49.9531" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M241.5,57.9531 L241.5,84.9531 M228.5,65.9531 L254.5,65.9531 M241.5,84.9531 L228.5,99.9531 M241.5,84.9531 L254.5,99.9531 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="390.5" y="119.9482">Good Responder</text><ellipse cx="453.5" cy="49.9531" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M453.5,57.9531 L453.5,84.9531 M440.5,65.9531 L466.5,65.9531 M453.5,84.9531 L440.5,99.9531 M453.5,84.9531 L466.5,99.9531 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="5" y="506.3076">Wrong Responder</text><ellipse cx="72.5" cy="436.3125" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M72.5,444.3125 L72.5,471.3125 M59.5,452.3125 L85.5,452.3125 M72.5,471.3125 L59.5,486.3125 M72.5,471.3125 L85.5,486.3125 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="209.5" y="506.3076">Initiator</text><ellipse cx="241.5" cy="436.3125" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M241.5,444.3125 L241.5,471.3125 M228.5,452.3125 L254.5,452.3125 M241.5,471.3125 L228.5,486.3125 M241.5,471.3125 L254.5,486.3125 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="390.5" y="506.3076">Good Responder</text><ellipse cx="453.5" cy="436.3125" fill="#FEFECE" filter="url(#fg5dppne2o3jh)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M453.5,444.3125 L453.5,471.3125 M440.5,452.3125 L466.5,452.3125 M453.5,471.3125 L440.5,486.3125 M453.5,471.3125 L466.5,486.3125 " fill="none" filter="url(#fg5dppne2o3jh)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="229.5,148.3828,239.5,152.3828,229.5,156.3828,233.5,152.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="235.5" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="191.5" y="147.3169">tun rx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="241.5" x2="283.5" y1="181.5156" y2="181.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="283.5" y1="181.5156" y2="194.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242.5" x2="283.5" y1="194.5156" y2="194.5156"/><polygon fill="#A80036" points="252.5,190.5156,242.5,194.5156,252.5,198.5156,248.5,194.5156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="248.5" y="176.4497">Stage 0: Prepare handshake</text><polygon fill="#A80036" points="83.5,219.6484,73.5,223.6484,83.5,227.6484,79.5,223.6484" style="stroke:#A80036;stroke-width:1.0;"/><ellipse cx="241" cy="222.8984" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><line style="stroke:#A80036;stroke-width:1.0;fill:none;" x1="77.5" x2="236.5" y1="223.6484" y2="223.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="109.5" y="218.5825">stage 1 packet</text><ellipse cx="241" cy="222.8984" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="441.5,219.6484,451.5,223.6484,441.5,227.6484,445.5,223.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="447.5" y1="223.6484" y2="223.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="300" y="218.5825">stage 1 packet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="453.5" x2="495.5" y1="252.7813" y2="252.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="495.5" x2="495.5" y1="252.7813" y2="265.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="454.5" x2="495.5" y1="265.7813" y2="265.7813"/><polygon fill="#A80036" points="464.5,261.7813,454.5,265.7813,464.5,269.7813,460.5,265.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="460.5" y="247.7153">Stage1: Stand up tunnel</text><line style="stroke:#A80036;stroke-width:1.0;" x1="72.5" x2="114.5" y1="252.7813" y2="252.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="114.5" x2="114.5" y1="252.7813" y2="265.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73.5" x2="114.5" y1="265.7813" y2="265.7813"/><polygon fill="#A80036" points="83.5,261.7813,73.5,265.7813,83.5,269.7813,79.5,265.7813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="79.5" y="247.7153">Stage1: Stand up tunnel</text><polygon fill="#A80036" points="252.5,290.9141,242.5,294.9141,252.5,298.9141,248.5,294.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="246.5" x2="452.5" y1="294.9141" y2="294.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="299.5" y="289.8481">Stage 2 packet</text><line style="stroke:#A80036;stroke-width:1.0;" x1="241.5" x2="283.5" y1="324.0469" y2="324.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="283.5" y1="324.0469" y2="337.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242.5" x2="283.5" y1="337.0469" y2="337.0469"/><polygon fill="#A80036" points="252.5,333.0469,242.5,337.0469,252.5,341.0469,248.5,337.0469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="248.5" y="318.981">Stand up tunnel</text><polygon fill="#A80036" points="229.5,362.1797,239.5,366.1797,229.5,370.1797,233.5,366.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="72.5" x2="235.5" y1="366.1797" y2="366.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="132.5" y="361.1138">Stage 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="241.5" x2="283.5" y1="395.3125" y2="395.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="283.5" y1="395.3125" y2="408.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="254.5" x2="283.5" y1="408.3125" y2="408.3125"/><line style="stroke:#A80036;stroke-width:2.0;" x1="247.5" x2="257.5" y1="403.3125" y2="413.3125"/><line style="stroke:#A80036;stroke-width:2.0;" x1="247.5" x2="257.5" y1="413.3125" y2="403.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="248.5" y="390.2466">Rejected, handshake complete</text><!--MD5=[5d6710fcab90e32b9d26f1fdef739a86]
@startuml
title Case 3: Wrong responder loses the race

!pragma teoz true
skinparam sequenceMessageAlign center

actor "Wrong Responder" as rw
actor Initiator as i
actor "Good Responder" as rg

?-> i: tun rx
i -> i: Stage 0: Prepare handshake

i o-> rw: stage 1 packet
& i o-> rg: stage 1 packet

rg -> rg: Stage1: Stand up tunnel
& rw -> rw: Stage1: Stand up tunnel

rg -> i: Stage 2 packet
i -> i: Stand up tunnel

rw -> i: Stage 2
i ->x i: Rejected, handshake complete
@enduml

PlantUML version 1.2021.5beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>