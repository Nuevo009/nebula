<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="473px" preserveAspectRatio="none" style="width:467px;height:473px;" version="1.1" viewBox="0 0 467 473" width="467px" zoomAndPan="magnify"><defs><filter height="300%" id="fohbg6er0sc68" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="194" x="136" y="28.708">Case 2: Stage 1 Race</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="69" x2="69" y1="123.25" y2="385.3125"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="265" x2="265" y1="123.25" y2="385.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="5" y="119.9482">Initiator 10.0.0.1</text><ellipse cx="69" cy="49.9531" fill="#FEFECE" filter="url(#fohbg6er0sc68)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M69,57.9531 L69,84.9531 M56,65.9531 L82,65.9531 M69,84.9531 L56,99.9531 M69,84.9531 L82,99.9531 " fill="none" filter="url(#fohbg6er0sc68)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="201.5" y="119.9482">Initiator 10.0.0.2</text><ellipse cx="265" cy="49.9531" fill="#FEFECE" filter="url(#fohbg6er0sc68)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M265,57.9531 L265,84.9531 M252,65.9531 L278,65.9531 M265,84.9531 L252,99.9531 M265,84.9531 L278,99.9531 " fill="none" filter="url(#fohbg6er0sc68)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="5" y="465.3076">Initiator 10.0.0.1</text><ellipse cx="69" cy="395.3125" fill="#FEFECE" filter="url(#fohbg6er0sc68)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M69,403.3125 L69,430.3125 M56,411.3125 L82,411.3125 M69,430.3125 L56,445.3125 M69,430.3125 L82,445.3125 " fill="none" filter="url(#fohbg6er0sc68)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="201.5" y="465.3076">Initiator 10.0.0.2</text><ellipse cx="265" cy="395.3125" fill="#FEFECE" filter="url(#fohbg6er0sc68)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M265,403.3125 L265,430.3125 M252,411.3125 L278,411.3125 M265,430.3125 L252,445.3125 M265,430.3125 L278,445.3125 " fill="none" filter="url(#fohbg6er0sc68)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="57,148.3828,67,152.3828,57,156.3828,61,152.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="63" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="18" y="147.3169">tun rx</text><polygon fill="#A80036" points="276,148.3828,266,152.3828,276,156.3828,272,152.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="270" x2="460" y1="152.3828" y2="152.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="344" y="147.3169">tun rx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="69" x2="111" y1="181.5156" y2="181.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="111" y1="181.5156" y2="194.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="70" x2="111" y1="194.5156" y2="194.5156"/><polygon fill="#A80036" points="80,190.5156,70,194.5156,80,198.5156,76,194.5156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="76" y="176.4497">Stage 0: Prepare handshake</text><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="307" y1="181.5156" y2="181.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="307" x2="307" y1="181.5156" y2="194.5156"/><line style="stroke:#A80036;stroke-width:1.0;" x1="266" x2="307" y1="194.5156" y2="194.5156"/><polygon fill="#A80036" points="276,190.5156,266,194.5156,276,198.5156,272,194.5156" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="272" y="176.4497">Stage 0: Prepare handshake</text><ellipse cx="68.5" cy="222.8984" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="85.5,219.6484,75.5,223.6484,85.5,227.6484,81.5,223.6484" style="stroke:#A80036;stroke-width:1.0;"/><ellipse cx="264.5" cy="222.8984" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="247.5,219.6484,257.5,223.6484,247.5,227.6484,251.5,223.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="83.5" x2="253.5" y1="223.6484" y2="223.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="103" y="218.5825">Both send a stage 1</text><line style="stroke:#A80036;stroke-width:1.0;" x1="69" x2="111" y1="283.0469" y2="283.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="111" y1="283.0469" y2="296.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="70" x2="111" y1="296.0469" y2="296.0469"/><polygon fill="#A80036" points="80,292.0469,70,296.0469,80,300.0469,76,296.0469" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="76" y="247.7153">Stage 1: They won the race</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="76" y="262.8481">Stand up tunnel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="76" y="277.981">delete my pending attempt</text><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="307" y1="283.0469" y2="283.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="307" x2="307" y1="283.0469" y2="296.0469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="278" x2="307" y1="296.0469" y2="296.0469"/><line style="stroke:#A80036;stroke-width:2.0;" x1="271" x2="281" y1="291.0469" y2="301.0469"/><line style="stroke:#A80036;stroke-width:2.0;" x1="271" x2="281" y1="301.0469" y2="291.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="272" y="262.8481">Stage 1: I won the race</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="272" y="277.981">Ignore this packet</text><polygon fill="#A80036" points="253,321.1797,263,325.1797,253,329.1797,257,325.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="69" x2="259" y1="325.1797" y2="325.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="142.5" y="320.1138">Stage 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="307" y1="354.3125" y2="354.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="307" x2="307" y1="354.3125" y2="367.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="266" x2="307" y1="367.3125" y2="367.3125"/><polygon fill="#A80036" points="276,363.3125,266,367.3125,276,371.3125,272,367.3125" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="272" y="349.2466">Stage 2: Stand up tunnel</text><!--MD5=[2adbfe50817d6da42b975c637a3b391c]
@startuml
title Case 2: Stage 1 Race

!pragma teoz true
skinparam sequenceMessageAlign center

actor "Initiator 10.0.0.1" as i1
actor "Initiator 10.0.0.2" as i2

-> i1: tun rx
& i2 <- : tun rx
i1 -> i1: Stage 0: Prepare handshake
& i2 -> i2: Stage 0: Prepare handshake

i1 o<->o i2: Both send a stage 1

i1 -> i1: Stage 1: They won the race\nStand up tunnel\ndelete my pending attempt
& i2 ->x i2: Stage 1: I won the race\nIgnore this packet

i1 -> i2: Stage 2
i2 -> i2: Stage 2: Stand up tunnel
@enduml

PlantUML version 1.2021.5beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>